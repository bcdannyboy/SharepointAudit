{
  "timestamp": "2025-07-03T11:12:28.025900",
  "api_calls": [
    {
      "timestamp": 1751566348.0260658,
      "method": "GET",
      "url": "https://graph.microsoft.com/v1.0/sites/delta",
      "elapsed_time": 0.6666922569274902,
      "success": true,
      "response_size": 0
    },
    {
      "timestamp": 1751566348.692787,
      "method": "GET",
      "url": "https://graph.microsoft.com/v1.0/sites/delta",
      "elapsed_time": 0.0002181529998779297,
      "success": true,
      "response_size": 0
    },
    {
      "timestamp": 1751566348.6930392,
      "method": "POST",
      "url": "https://graph.microsoft.com/v1.0/search/query",
      "elapsed_time": 0.00011873245239257812,
      "success": true,
      "request_body": {
        "requests": [
          {
            "entityTypes": [
              "site"
            ],
            "query": {
              "queryString": "NOT path:*/personal/* AND NOT displayName:*archived* AND NOT displayName:*test* AND NOT displayName:*old*"
            },
            "from": 0,
            "size": 25,
            "fields": [
              "id",
              "webUrl",
              "displayName",
              "description",
              "createdDateTime",
              "lastModifiedDateTime"
            ]
          }
        ]
      }
    },
    {
      "timestamp": 1751566348.693181,
      "method": "POST",
      "url": "https://graph.microsoft.com/v1.0/search/query",
      "elapsed_time": 0.00011515617370605469,
      "success": true,
      "request_body": {
        "requests": [
          {
            "entityTypes": [
              "site"
            ],
            "query": {
              "queryString": "NOT path:*/personal/* AND NOT path:*/appcatalog/* AND NOT displayName:*archived* AND NOT displayName:*test* AND NOT displayName:*demo* AND NOT displayName:*old* AND NOT displayName:*backup*"
            },
            "from": 0,
            "size": 25,
            "fields": [
              "id",
              "webUrl",
              "displayName",
              "description",
              "createdDateTime",
              "lastModifiedDateTime"
            ]
          }
        ]
      }
    },
    {
      "timestamp": 1751566348.6933131,
      "method": "POST",
      "url": "https://graph.microsoft.com/v1.0/search/query",
      "elapsed_time": 0.00011277198791503906,
      "success": true,
      "request_body": {
        "requests": [
          {
            "entityTypes": [
              "site"
            ],
            "query": {
              "queryString": "contentClass:STS_Site AND NOT path:*/personal/* AND NOT displayName:*archived*"
            },
            "from": 0,
            "size": 25,
            "fields": [
              "id",
              "webUrl",
              "displayName",
              "description",
              "createdDateTime",
              "lastModifiedDateTime"
            ]
          }
        ]
      }
    },
    {
      "timestamp": 1751566348.693485,
      "method": "GET",
      "url": "https://graph.microsoft.com/v1.0/sites?$filter=isArchived eq false&$top=25",
      "elapsed_time": 0.0002009868621826172,
      "success": true,
      "response_size": 0
    },
    {
      "timestamp": 1751566348.6937048,
      "method": "GET",
      "url": "https://graph.microsoft.com/v1.0/sites?$filter=deleted eq null&$top=25",
      "elapsed_time": 0.00017905235290527344,
      "success": true,
      "response_size": 0
    },
    {
      "timestamp": 1751566348.693898,
      "method": "GET",
      "url": "https://graph.microsoft.com/v1.0/sites?$filter=not(startswith(displayName,'archived'))&$top=25",
      "elapsed_time": 0.00018715858459472656,
      "success": true,
      "response_size": 0
    },
    {
      "timestamp": 1751566348.694102,
      "method": "GET",
      "url": "https://graph.microsoft.com/v1.0/sites?$filter=not(startswith(displayName,'test'))&$top=25",
      "elapsed_time": 0.00019884109497070312,
      "success": true,
      "response_size": 0
    },
    {
      "timestamp": 1751566348.694315,
      "method": "GET",
      "url": "https://graph.microsoft.com/v1.0/sites?$filter=not(startswith(displayName,'archived')) and not(startswith(displayName,'test'))&$top=25",
      "elapsed_time": 0.00016808509826660156,
      "success": true,
      "response_size": 0
    },
    {
      "timestamp": 1751566348.694509,
      "method": "POST",
      "url": "https://graph.microsoft.com/v1.0/search/query",
      "elapsed_time": 9.489059448242188e-05,
      "success": true,
      "request_body": {
        "requests": [
          {
            "entityTypes": [
              "site"
            ],
            "query": {
              "queryString": "NOT path:*/personal/*"
            },
            "from": 0,
            "size": 25,
            "fields": [
              "id",
              "webUrl",
              "displayName",
              "description",
              "createdDateTime",
              "lastModifiedDateTime"
            ]
          }
        ]
      }
    },
    {
      "timestamp": 1751566348.6946518,
      "method": "GET",
      "url": "https://graph.microsoft.com/v1.0/sites/delta?$top=10&$select=*",
      "elapsed_time": 0.00016617774963378906,
      "success": true,
      "response_size": 0
    }
  ],
  "current_approach": {
    "method": "Delta API + Search API fallback + client-side filtering",
    "sites_returned": 0,
    "elapsed_time": 0.666696310043335,
    "api_calls_made": 1,
    "sample_sites": [],
    "all_sites_count": 0,
    "all_sites_time": 0.0002200603485107422
  },
  "proposed_approaches": {
    "enhanced_search_api": {
      "method": "Enhanced Search API with OData filtering",
      "queries_tested": 3,
      "results": {
        "query_1": {
          "query": "NOT path:*/personal/* AND NOT displayName:*archived* AND NOT displayName:*test* AND NOT displayName:*old*",
          "sites_found": 0,
          "elapsed_time": 0.00012183189392089844,
          "sample_sites": []
        },
        "query_2": {
          "query": "NOT path:*/personal/* AND NOT path:*/appcatalog/* AND NOT displayName:*archived* AND NOT displayName:*test* AND NOT displayName:*demo* AND NOT displayName:*old* AND NOT displayName:*backup*",
          "sites_found": 0,
          "elapsed_time": 0.00011801719665527344,
          "sample_sites": []
        },
        "query_3": {
          "query": "contentClass:STS_Site AND NOT path:*/personal/* AND NOT displayName:*archived*",
          "sites_found": 0,
          "elapsed_time": 0.00011610984802246094,
          "sample_sites": []
        }
      },
      "total_elapsed_time": 0.0004279613494873047,
      "api_calls_made": 3
    },
    "sites_endpoint_filtering": {
      "method": "Sites endpoint with OData filters",
      "filters_tested": 5,
      "results": {
        "filter_1": {
          "filter": "$filter=isArchived eq false",
          "sites_found": 0,
          "elapsed_time": 0.0002040863037109375,
          "sample_sites": []
        },
        "filter_2": {
          "filter": "$filter=deleted eq null",
          "sites_found": 0,
          "elapsed_time": 0.00018215179443359375,
          "sample_sites": []
        },
        "filter_3": {
          "filter": "$filter=not(startswith(displayName,'archived'))",
          "sites_found": 0,
          "elapsed_time": 0.0001888275146484375,
          "sample_sites": []
        },
        "filter_4": {
          "filter": "$filter=not(startswith(displayName,'test'))",
          "sites_found": 0,
          "elapsed_time": 0.00020074844360351562,
          "sample_sites": []
        },
        "filter_5": {
          "filter": "$filter=not(startswith(displayName,'archived')) and not(startswith(displayName,'test'))",
          "sites_found": 0,
          "elapsed_time": 0.00016999244689941406,
          "sample_sites": []
        }
      },
      "total_elapsed_time": 0.0010139942169189453,
      "api_calls_made": 5
    },
    "combined_approach": {
      "method": "Search API + detailed property validation",
      "candidate_sites_found": 0,
      "detailed_sites_analyzed": 0,
      "estimated_active_sites": 0,
      "elapsed_time": 0.00011181831359863281,
      "api_calls_made": 1,
      "sample_detailed_sites": []
    }
  },
  "site_samples": [],
  "performance_metrics": {
    "current_implementation": {
      "api_calls": 1,
      "elapsed_time": 0.666696310043335,
      "sites_per_second": 0.0
    },
    "enhanced_search_api": {
      "api_calls": 3,
      "elapsed_time": 0.0004279613494873047,
      "estimated_efficiency_gain": 99.93580865184937
    },
    "combined_approach": {
      "api_calls": 1,
      "elapsed_time": 0.00011181831359863281,
      "estimated_efficiency_gain": 99.98322799872832
    }
  },
  "recommendations": [
    "Enhanced Search API could improve performance by 99.9%"
  ]
}
